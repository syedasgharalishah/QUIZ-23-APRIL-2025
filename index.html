<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSS MPT Daily Quiz - June 20, 2025</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Base styles for body */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F8F9FA; /* Very light gray */
            color: #2C3E50; /* Main text color */
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            overflow-x: hidden; /* Prevent horizontal scrolling */
        }

        /* Styling for the top navigation bar */
        .top-bar {
            background-color: #ffffff;
            border-bottom: 1px solid #e0e0e0;
            padding: 0.75rem 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        /* Styling for the date display in the top bar */
        .top-bar .date-display {
            color: #6D6875;
            font-size: 0.9rem;
            font-weight: 600;
            display: flex; /* Added for icon alignment */
            align-items: center; /* Added for icon alignment */
            gap: 0.5rem; /* Space between icon and text */
        }

        /* Styling for the WhatsApp community link in the top bar */
        .top-bar .whatsapp-link {
            color: #6D6875;
            text-decoration: none;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Header section styling, including quiz title and progress bar */
        .header-section {
            background-color: #ffffff;
            padding: 1.5rem 1rem;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            margin-bottom: 1rem;
        }

        /* Main quiz title styling */
        .quiz-title {
            font-family: 'Roboto', sans-serif;
            font-size: 1.8rem;
            font-weight: 700;
            color: #2C3E50;
            margin-bottom: 1rem;
        }

        /* Container for the progress bar */
        .progress-bar-container {
            width: 80%;
            max-width: 600px;
            height: 10px;
            background-color: #e0e0e0;
            border-radius: 5px;
            margin: 1rem auto;
            overflow: hidden;
        }

        /* Actual progress bar styling */
        .progress-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(to right, #20B2AA, #3EB489); /* Gradient from light teal to mint green */
            border-radius: 5px;
            transition: width 0.3s ease-in-out; /* Smooth transition for width changes */
        }

        /* Banner logo image styling */
        .banner-logo {
            max-width: 200px;
            height: auto;
            border-radius: 8px;
            margin-top: 1rem;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1); /* Soft shadow */
        }

        /* Credits text styling */
        .credits {
            font-size: 0.85rem;
            color: #2C3E50; /* Main text color */
            margin-top: 0.5rem;
            font-weight: bold; /* Bold text for credits */
        }

        /* General card styling for login, quiz, and results pages */
        .card {
            background-color: #FFF5EE; /* PeachPuff */
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            padding: 1.5rem;
            margin: 1rem auto;
            max-width: 700px;
            width: 90%;
            box-sizing: border-box; /* Include padding and border in the element's total width and height */
        }

        /* Button styling with gradient and hover effects */
        .button-gradient {
            background-image: linear-gradient(to right, #E6E6FA, #FFDAB9); /* Lavender to PeachPuff */
            color: #2C3E50;
            font-weight: bold;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            cursor: pointer;
            border: none;
        }

        /* Hover effect for gradient buttons */
        .button-gradient:hover {
            transform: translateY(-2px); /* Slight lift effect */
            box-shadow: 0 6px 12px rgba(0,0,0,0.15); /* Enhanced shadow */
        }

        /* Active (click) effect for gradient buttons */
        .button-gradient:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1); /* Reduced shadow */
        }

        /* Styling for quiz option buttons */
        .option-button {
            background-color: #ffffff;
            border: 1px solid #ddd;
            padding: 0.75rem 1rem;
            border-radius: 8px;
            text-align: left;
            cursor: pointer;
            transition: all 0.2s ease; /* Smooth transitions for all properties */
            margin-bottom: 0.75rem;
            color: #2C3E50;
            font-weight: normal;
        }
        
        /* Hover effect for option buttons, excluding selected ones */
        .option-button:hover:not(.selected) {
            transform: scale(1.02); /* Enlarge slightly on hover */
            box-shadow: 0 6px 12px rgba(0,0,0,0.1);
        }

        /* Styling for selected option button */
        .option-button.selected {
            border-color: #6D6875;
            background-color: #f0f0f0;
            font-weight: bold;
        }

        /* Styling for correct answer option button */
        .option-button.correct {
            background-color: #90EE90; /* LightGreen */
            border-color: #28a745;
            animation: pulse-green 0.5s ease-out forwards; /* Pulse animation */
        }

        /* Styling for incorrect answer option button */
        .option-button.incorrect {
            background-color: #FF6B6B; /* Red pulse */
            border-color: #dc3545;
            animation: shake-red 0.5s ease-out forwards; /* Shake animation */
        }

        /* Styling for special question card */
        .special-question {
            border: 3px solid #FFD700; /* Gold border */
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.5); /* Glowing effect */
        }

        /* Styling for explanation div */
        .explanation {
            background-color: #e0f7fa; /* Light cyan background */
            border-left: 5px solid #20B2AA; /* Teal left border */
            padding: 1rem;
            margin-top: 1rem;
            border-radius: 8px;
            color: #2C3E50;
            font-size: 0.9rem;
            display: none; /* Hidden by default */
        }

        /* Styling for timer display */
        .timer-display {
            font-size: 1.2rem;
            font-weight: bold;
            color: #2C3E50;
            margin-bottom: 1rem;
            text-align: center;
        }

        /* Styling for question progress text */
        .question-progress {
            font-size: 1rem;
            color: #6D6875;
            margin-bottom: 1rem;
            text-align: center;
        }

        /* Responsive adjustments for smaller screens (mobile) */
        @media (max-width: 768px) {
            .top-bar {
                flex-direction: column; /* Stack items vertically */
                gap: 0.5rem;
                padding: 0.5rem;
                align-items: flex-start; /* Align to start on mobile */
            }
            .top-bar .date-display {
                order: 1; /* Move date to top-left on mobile */
                font-size: 0.8rem;
                align-self: flex-start; /* Align to start on mobile */
            }
            .top-bar .whatsapp-link {
                order: 2; /* Move whatsapp to bottom on mobile */
                font-size: 0.8rem;
                align-self: flex-end; /* Align to end on mobile */
            }
            .quiz-title {
                font-size: 1.5rem;
            }
            .banner-logo {
                max-width: 150px;
            }
            .card {
                margin: 0.75rem auto;
                padding: 1rem;
            }
            .button-gradient {
                padding: 0.6rem 1.2rem;
                font-size: 0.9rem;
            }
            .option-button {
                padding: 0.6rem 0.8rem;
                font-size: 0.9rem;
            }
        }

        /* Keyframe animation for correct answer pulse */
        @keyframes pulse-green {
            0% { box-shadow: 0 0 0 0 rgba(144, 238, 144, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(144, 238, 144, 0); }
            100% { box-shadow: 0 0 0 0 rgba(144, 238, 144, 0); }
        }

        /* Keyframe animation for wrong answer shake */
        @keyframes shake-red {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
    </style>
</head>
<body>

    <!-- Security script to disable right-click, F12, Ctrl+U/I/J, copy, and paste -->
    <script>
        document.addEventListener('contextmenu', event => event.preventDefault()); // Disable right-click
        document.addEventListener('keydown', e => {
            if (e.ctrlKey && (e.key === 'u' || e.key === 'U' || e.key === 'I' || e.key === 'i' || e.key === 'J' || e.key === 'j')) {
                e.preventDefault(); // Disable Ctrl+U, Ctrl+Shift+I, Ctrl+Shift+J
            }
            if (e.key === 'F12') {
                e.preventDefault(); // Disable F12
            }
        });
        document.addEventListener('copy', event => event.preventDefault()); // Disable copy
        document.addEventListener('paste', event => event.preventDefault()); // Disable paste
    </script>

    <!-- Top bar for date and WhatsApp link -->
    <div class="top-bar">
        <div class="date-display" id="liveDate">
            <i class="fas fa-calendar-alt"></i> <span id="currentDateText"></span>
        </div>
        <a href="https://chat.whatsapp.com/your-whatsapp-community-link" target="_blank" class="whatsapp-link">
            <i class="fab fa-whatsapp"></i> Join WhatsApp Community
        </a>
    </div>

    <!-- Header section with quiz title, progress bar, logo, and credits -->
    <div class="header-section">
        <h1 class="quiz-title" id="quizTitle"></h1>
        <div class="progress-bar-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>
        <img src="https://i.ibb.co/tMYHtj6n/480709804-2211254089269599-2819007219717277160-n.jpg" alt="Banner Logo" class="banner-logo mx-auto">
        <div class="credits">
            DAWNDIGEST
            <br>
            PREPARED BY: SYED ASGHAR ALI SHAH Contact: 03265762698
            <br>
            Updated on: <span id="updatedDate"></span>
        </div>
    </div>

    <!-- Main content area for different quiz pages -->
    <main class="flex-grow flex items-center justify-center p-4">
        <!-- Login Page -->
        <div id="loginPage" class="card">
            <h2 class="text-xl font-bold mb-4 text-center">Login</h2>
            <div class="mb-4">
                <label for="loginId" class="block text-sm font-medium text-gray-700 mb-1">ID:</label>
                <input type="text" id="loginId" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500" value="">
            </div>
            <div class="mb-6">
                <label for="loginPassword" class="block text-sm font-medium text-gray-700 mb-1">Password:</label>
                <input type="password" id="loginPassword" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500" value="">
            </div>
            <p id="loginError" class="text-red-500 text-sm mb-4 hidden">Invalid ID or Password</p>
            <button id="loginBtn" class="button-gradient w-full">Login</button>
        </div>

        <!-- Candidate Name Entry Page -->
        <div id="candidateNamePage" class="card hidden">
            <h2 class="text-xl font-bold mb-4 text-center">Candidate Information</h2>
            <div class="mb-6">
                <label for="candidateName" class="block text-sm font-medium text-gray-700 mb-1">Enter Full Name:</label>
                <input type="text" id="candidateName" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500" placeholder="Your Full Name">
            </div>
            <p id="nameError" class="text-red-500 text-sm mb-4 hidden">Please enter your full name.</p>
            <button id="startQuizBtn" class="button-gradient w-full">Start Quiz</button>
        </div>

        <!-- Quiz Page -->
        <div id="quizPage" class="card hidden">
            <div class="timer-display" id="timerDisplay"></div>
            <div class="question-progress" id="questionProgress"></div>
            <h2 class="text-lg font-semibold mb-4" id="questionText"></h2>
            <div id="optionsContainer" class="flex flex-col gap-3 mb-6">
                <!-- Options will be dynamically loaded here -->
            </div>
            <div class="flex justify-between">
                <button id="prevBtn" class="button-gradient px-6 py-2">Previous</button>
                <button id="nextBtn" class="button-gradient px-6 py-2">Next</button>
                <button id="submitQuizBtn" class="button-gradient px-6 py-2 hidden">Submit Quiz</button>
            </div>
            <div id="explanationDiv" class="explanation"></div>
        </div>

        <!-- Results Page -->
        <div id="resultsPage" class="card hidden">
            <h2 class="text-xl font-bold mb-4 text-center">Quiz Results</h2>
            <p class="mb-2"><strong>Candidate Name:</strong> <span id="resultCandidateName"></span></p>
            <p class="mb-2"><strong>Date of Quiz:</strong> <span id="resultDate"></span></p>
            <p class="mb-2"><strong>Score:</strong> <span id="resultScore"></span> / 200</p>
            <p class="mb-2"><strong>Correct Answers:</strong> <span id="resultCorrect"></span></p>
            <p class="mb-2"><strong>Incorrect Answers:</strong> <span id="resultIncorrect"></span></p>
            <p class="mb-4"><strong>Time Taken:</strong> <span id="resultTimeTaken"></span></p>
            <button id="restartQuizBtn" class="button-gradient w-full">Restart Quiz</button>
        </div>
    </main>

    <script>
        // Set the current date for display and login logic
        const CURRENT_DATE_STR = "June 20, 2025";
        const CURRENT_DATE = new Date(CURRENT_DATE_STR);

        // Update header elements with the current date
        document.getElementById('currentDateText').textContent = CURRENT_DATE_STR;
        document.getElementById('updatedDate').textContent = CURRENT_DATE_STR;
        document.getElementById('quizTitle').textContent = `CSS MPT Daily Quiz – ${CURRENT_DATE_STR}`;

        // Quiz Data Structure and State Variables
        let quizQuestions = []; // Array to hold all quiz questions
        let currentQuestionIndex = 0; // Index of the currently displayed question
        let userAnswers = []; // Stores user's selected answers and correctness
        let quizStartTime; // Timestamp when the quiz starts
        let timerInterval; // Interval ID for the quiz timer
        const QUIZ_DURATION_MINUTES = 40; // Total duration for the quiz
        let specialQuestionIndex = -1; // Index for the "Today's Special Question"

        // --- Helper Functions ---

        /**
         * Shuffles an array in place using the Fisher-Yates (Knuth) algorithm.
         * @param {Array} array - The array to be shuffled.
         */
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]]; // Swap elements
            }
        }

        /**
         * Generates a unique ID for Formspree submission, ensuring submission uniqueness.
         * @returns {string} A unique string ID.
         */
        function generateUniqueId() {
            return 'quiz_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }

        /**
         * Converts total seconds into a human-readable time string (e.g., "XX minutes YY seconds").
         * @param {number} totalSeconds - The total number of seconds elapsed or remaining.
         * @returns {string} Formatted time string.
         */
        function formatTime(totalSeconds) {
            const minutes = Math.floor(totalSeconds / 60);
            const seconds = totalSeconds % 60;
            return `${minutes} minutes ${seconds} seconds`;
        }

        /**
         * Updates the visual progress bar and text indicating current question progress.
         */
        function updateProgressBar() {
            const progress = ((currentQuestionIndex + 1) / quizQuestions.length) * 100;
            document.getElementById('progressBar').style.width = `${progress}%`;
            document.getElementById('questionProgress').textContent = `Question ${currentQuestionIndex + 1}/${quizQuestions.length} – ${Math.round(progress)}% Complete`;
        }

        /**
         * Displays a specified page by adding/removing 'hidden' class to relevant divs.
         * @param {string} pageId - The ID of the HTML element (page div) to show.
         */
        function showPage(pageId) {
            // Hide all potential quiz pages
            document.getElementById('loginPage').classList.add('hidden');
            document.getElementById('candidateNamePage').classList.add('hidden');
            document.getElementById('quizPage').classList.add('hidden');
            document.getElementById('resultsPage').classList.add('hidden');
            // Show the requested page
            document.getElementById(pageId).classList.remove('hidden');
        }

        /**
         * Initializes and starts the countdown timer for the quiz.
         * Automatically submits the quiz when time runs out.
         */
        function startTimer() {
            quizStartTime = Date.now();
            let timeLeft = QUIZ_DURATION_MINUTES * 60; // Convert minutes to seconds

            function updateTimerDisplay() {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                document.getElementById('timerDisplay').textContent = `Time Left: ${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

                if (timeLeft <= 0) {
                    clearInterval(timerInterval); // Stop the timer
                    submitQuiz(true); // Auto-submit on timer expiry
                } else {
                    timeLeft--; // Decrement time
                }
            }

            updateTimerDisplay(); // Call once immediately for initial display
            timerInterval = setInterval(updateTimerDisplay, 1000); // Update every second
        }

        /**
         * Renders the current question, its options, and manages visual feedback.
         * Handles displaying explanations and navigation buttons.
         */
        function renderQuestion() {
            const question = quizQuestions[currentQuestionIndex];
            document.getElementById('questionText').innerHTML = question.question; // Set question text
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = ''; // Clear previously rendered options

            // Remove special-question class from the quiz card if it was applied to a previous question
            const quizCard = document.getElementById('quizPage');
            quizCard.classList.remove('special-question');

            // Apply special-question class if the current question is marked as special
            const today = new Date();
            const todayNormalized = new Date(today.getFullYear(), today.getMonth(), today.getDate());
            const currentQuizDateNormalized = new Date(CURRENT_DATE.getFullYear(), CURRENT_DATE.getMonth(), CURRENT_DATE.getDate());

            if (question.special && todayNormalized.getTime() === currentQuizDateNormalized.getTime()) {
                quizCard.classList.add('special-question');
            }

            // Shuffle the options for the current question to randomize their order
            const shuffledOptions = [...question.options];
            shuffleArray(shuffledOptions);

            shuffledOptions.forEach((option, index) => {
                const button = document.createElement('button');
                button.classList.add('option-button', 'w-full');
                button.textContent = option;
                // Store the original index of the option (before shuffling) for correctness checking
                button.dataset.originalOptionIndex = question.options.indexOf(option);
                button.onclick = () => selectOption(parseInt(button.dataset.originalOptionIndex)); // Attach click handler

                // Check if the user has already answered this question and apply visual feedback
                const userAnswer = userAnswers[currentQuestionIndex];
                if (userAnswer && userAnswer.selectedOptionIndex === parseInt(button.dataset.originalOptionIndex)) {
                    button.classList.add('selected'); // Mark as selected
                    if (userAnswer.isCorrect) {
                        button.classList.add('correct'); // Mark as correct
                    } else {
                        button.classList.add('incorrect'); // Mark as incorrect
                    }
                    // Disable all options once an answer is selected for this question
                    Array.from(optionsContainer.children).forEach(optBtn => optBtn.disabled = true);
                    document.getElementById('explanationDiv').style.display = 'block'; // Show explanation if answered
                }
                optionsContainer.appendChild(button);
            });

            // Set and display the explanation for the current question
            const explanationDiv = document.getElementById('explanationDiv');
            explanationDiv.innerHTML = `<p class="font-bold">Explanation:</p><p>${question.explanation}</p>`;
            // Show explanation only if the question has been answered
            if (userAnswers[currentQuestionIndex] && userAnswers[currentQuestionIndex].selectedOptionIndex !== undefined) {
                explanationDiv.style.display = 'block';
            } else {
                explanationDiv.style.display = 'none'; // Hide if not answered
            }

            // Manage visibility of navigation buttons (Previous, Next, Submit)
            document.getElementById('prevBtn').classList.toggle('hidden', currentQuestionIndex === 0); // Hide 'Previous' on first question
            document.getElementById('nextBtn').classList.toggle('hidden', currentQuestionIndex === quizQuestions.length - 1); // Hide 'Next' on last question
            document.getElementById('submitQuizBtn').classList.toggle('hidden', currentQuestionIndex !== quizQuestions.length - 1); // Show 'Submit' only on last question

            updateProgressBar(); // Update progress bar and text
        }

        /**
         * Handles user's option selection, updates internal state, and provides visual feedback.
         * @param {number} selectedOptionOriginalIndex - The original index of the option selected by the user.
         */
        function selectOption(selectedOptionOriginalIndex) {
            const question = quizQuestions[currentQuestionIndex];
            // If the question has already been answered, prevent re-selection
            if (userAnswers[currentQuestionIndex] && userAnswers[currentQuestionIndex].selectedOptionIndex !== undefined) {
                return;
            }

            const isCorrect = (selectedOptionOriginalIndex === question.correctOptionIndex);

            // Store the user's answer and its correctness
            userAnswers[currentQuestionIndex] = {
                questionIndex: currentQuestionIndex,
                selectedOptionIndex: selectedOptionOriginalIndex,
                isCorrect: isCorrect
            };

            // Apply visual feedback to all option buttons and disable them
            const optionsContainer = document.getElementById('optionsContainer');
            Array.from(optionsContainer.children).forEach((button) => {
                button.disabled = true; // Disable all options after a selection is made
                button.classList.remove('option-button:hover:not(.selected)'); // Remove hover effect once selected

                const btnOriginalIndex = parseInt(button.dataset.originalOptionIndex);

                if (btnOriginalIndex === selectedOptionOriginalIndex) {
                    button.classList.add('selected'); // Mark the selected button
                    if (isCorrect) {
                        button.classList.add('correct'); // Green for correct
                    } else {
                        button.classList.add('incorrect'); // Red for incorrect
                    }
                }
                // If the selected answer was incorrect, also highlight the correct answer
                if (!isCorrect && btnOriginalIndex === question.correctOptionIndex) {
                    button.classList.add('correct'); // Highlight the true correct answer
                }
            });

            // Show the explanation for the current question
            document.getElementById('explanationDiv').style.display = 'block';
        }

        /**
         * Advances to the next question if available.
         */
        function nextQuestion() {
            if (currentQuestionIndex < quizQuestions.length - 1) {
                currentQuestionIndex++;
                renderQuestion(); // Render the new question
            }
        }

        /**
         * Goes back to the previous question if available.
         */
        function prevQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                renderQuestion(); // Render the previous question
            }
        }

        /**
         * Submits the quiz, calculates the score, displays results, and sends data to Formspree.
         * @param {boolean} isAutoSubmit - True if the quiz was submitted automatically (e.g., by timer expiry).
         */
        function submitQuiz(isAutoSubmit = false) {
            clearInterval(timerInterval); // Stop the quiz timer

            const endTime = Date.now();
            const timeTakenSeconds = Math.round((endTime - quizStartTime) / 1000);

            let correctCount = 0;
            let incorrectCount = 0;
            let attemptedCount = 0;

            // Calculate results based on user answers
            userAnswers.forEach(answer => {
                if (answer && answer.selectedOptionIndex !== undefined) {
                    attemptedCount++;
                    if (answer.isCorrect) {
                        correctCount++;
                    } else {
                        incorrectCount++;
                    }
                }
            });

            // Score calculation: 2 marks for correct, -1 for incorrect
            const score = (correctCount * 2) - (incorrectCount * 1);
            const candidateName = document.getElementById('candidateName').value;

            // Update results display on the results page
            document.getElementById('resultCandidateName').textContent = candidateName;
            document.getElementById('resultDate').textContent = CURRENT_DATE_STR;
            document.getElementById('resultScore').textContent = score;
            document.getElementById('resultCorrect').textContent = `${correctCount}`;
            document.getElementById('resultIncorrect').textContent = `${incorrectCount}`;
            document.getElementById('resultTimeTaken').textContent = formatTime(timeTakenSeconds);

            showPage('resultsPage'); // Display the results page

            // Prepare data for silent Formspree submission
            const formData = new FormData();
            formData.append('Candidate Name', candidateName);
            formData.append('Date of Quiz', CURRENT_DATE_STR);
            formData.append('Score', score);
            formData.append('Correct Answers', correctCount);
            formData.append('Incorrect Answers', incorrectCount);
            formData.append('Time Taken', formatTime(timeTakenSeconds));
            formData.append('Quiz ID', generateUniqueId()); // Unique ID for each submission

            // Send data to Formspree (replace with your actual Formspree endpoint)
            fetch('https://formspree.io/f/xwpvddea', { // This is a placeholder Formspree endpoint
                method: 'POST',
                body: formData,
                headers: {
                    'Accept': 'application/json'
                }
            }).then(response => {
                if (response.ok) {
                    console.log('Quiz results submitted successfully!');
                } else {
                    console.error('Formspree submission failed.');
                }
            }).catch(error => {
                console.error('Error during Formspree submission:', error);
            });
        }

        // --- Event Listeners ---

        // Login button click handler
        document.getElementById('loginBtn').addEventListener('click', () => {
            const id = document.getElementById('loginId').value;
            const password = document.getElementById('loginPassword').value;
            const loginError = document.getElementById('loginError');

            // Login credentials for June 20 quiz
            const expectedLoginId = "20JUNE"; // Dynamically set login ID
            const expectedPassword = "free"; // Password is "free"

            if (id === expectedLoginId && password === expectedPassword) {
                loginError.classList.add('hidden'); // Hide error message
                showPage('candidateNamePage'); // Proceed to name entry page
            } else {
                loginError.classList.remove('hidden'); // Show error message
            }
        });

        // Start Quiz button click handler
        document.getElementById('startQuizBtn').addEventListener('click', () => {
            const candidateNameInput = document.getElementById('candidateName');
            const candidateName = candidateNameInput.value.trim();
            const nameError = document.getElementById('nameError');

            if (candidateName) {
                nameError.classList.add('hidden'); // Hide error message
                // Reset quiz state for a new attempt
                userAnswers = new Array(quizQuestions.length).fill(null); // Clear previous answers
                currentQuestionIndex = 0; // Start from the first question
                startTimer(); // Start the quiz timer
                renderQuestion(); // Render the first question
                showPage('quizPage'); // Display the quiz page
            } else {
                nameError.classList.remove('hidden'); // Prompt for name if empty
            }
        });

        // Navigation and Submission Button Handlers
        document.getElementById('nextBtn').addEventListener('click', nextQuestion);
        document.getElementById('prevBtn').addEventListener('click', prevQuestion);
        document.getElementById('submitQuizBtn').addEventListener('click', () => submitQuiz(false)); // Manual submission
        document.getElementById('restartQuizBtn').addEventListener('click', () => {
            // Reset full quiz state
            currentQuestionIndex = 0;
            userAnswers = [];
            clearInterval(timerInterval); // Ensure timer is cleared
            initializeQuiz(); // Re-initialize and re-shuffle questions for a fresh start
            showPage('loginPage'); // Go back to the login page
        });

        // --- Quiz Initialization Function ---
        function initializeQuiz() {
            // Clear any existing questions
            quizQuestions.length = 0;

            // General Knowledge & Current Affairs (Pages 171-200) - Aim for 50 questions
            const generalKnowledgeMCQs = [
                { question: "Which major international organization was formed in 1945 to promote international cooperation?", options: ["League of Nations", "United Nations", "NATO", "European Union"], correctOptionIndex: 1, explanation: "The United Nations (UN) was established in 1945 after World War II to promote international peace and security.", difficulty: "easy", source_page: 171 },
                { question: "The current Secretary-General of the United Nations is:", options: ["Ban Ki-moon", "Kofi Annan", "António Guterres", "Boutros Boutros-Ghali"], correctOptionIndex: 2, explanation: "António Guterres of Portugal is the current (as of 2024) Secretary-General of the UN.", difficulty: "medium", source_page: 172 },
                { question: "The International Court of Justice is located in which city?", options: ["New York", "Geneva", "The Hague", "Vienna"], correctOptionIndex: 2, explanation: "The International Court of Justice (ICJ), the principal judicial organ of the UN, is located at the Peace Palace in The Hague, Netherlands.", difficulty: "medium", source_page: 173 },
                { question: "Which UN body is responsible for maintaining international peace and security?", options: ["General Assembly", "Economic and Social Council", "Security Council", "Secretariat"], correctOptionIndex: 2, explanation: "The UN Security Council has primary responsibility for maintaining international peace and security.", difficulty: "easy", source_page: 174 },
                { question: "The headquarters of UNICEF are in:", options: ["Rome", "Paris", "New York", "London"], correctOptionIndex: 2, explanation: "UNICEF (United Nations Children's Fund) is headquartered in New York City.", difficulty: "easy", source_page: 175 },
                { question: "The World Bank Group provides financial and technical assistance to developing countries. Its headquarters are in:", options: ["Brussels", "Washington D.C.", "Tokyo", "Berlin"], correctOptionIndex: 1, explanation: "The World Bank Group is headquartered in Washington, D.C., United States.", difficulty: "easy", source_page: 176 },
                { question: "Which international treaty aims to prevent the spread of nuclear weapons and promote peaceful uses of nuclear energy?", options: ["Geneva Conventions", "Kyoto Protocol", "Non-Proliferation Treaty (NPT)", "Paris Agreement"], correctOptionIndex: 2, explanation: "The Treaty on the Non-Proliferation of Nuclear Weapons (NPT) is a landmark international treaty whose objective is to prevent the spread of nuclear weapons.", difficulty: "tough", source_page: 177 },
                { question: "The G7 is a forum of highly industrialized nations. Which of the following is NOT a G7 member?", options: ["Canada", "Germany", "Russia", "Japan"], correctOptionIndex: 2, explanation: "The G7 consists of Canada, France, Germany, Italy, Japan, the United Kingdom, and the United States. Russia was part of the G8 but was suspended.", difficulty: "medium", source_page: 178 },
                { question: "The International Criminal Court (ICC) investigates and, where warranted, tries individuals charged with the gravest crimes of concern to the international community. Its seat is in:", options: ["New York", "Rome", "The Hague", "Geneva"], correctOptionIndex: 2, explanation: "The International Criminal Court (ICC) is located in The Hague, Netherlands.", difficulty: "medium", source_page: 179 },
                { question: "Which of the following is an agency of the United Nations that deals with international labor standards?", options: ["WHO", "FAO", "ILO", "IMF"], correctOptionIndex: 2, explanation: "The International Labour Organization (ILO) is a United Nations agency whose mandate is to advance social and economic justice through setting international labour standards.", difficulty: "medium", source_page: 180 },
                { question: "What does ASEAN stand for?", options: ["Association of South Asian Nations", "Alliance of Southeast Asian Nations", "Association of Southeast Asian Nations", "Asian Economic Alliance of Nations"], correctOptionIndex: 2, explanation: "ASEAN stands for the Association of Southeast Asian Nations.", difficulty: "easy", source_page: 181 },
                { question: "Which country is NOT a permanent member of the UN Security Council?", options: ["China", "France", "Germany", "United Kingdom"], correctOptionIndex: 2, explanation: "The five permanent members of the UN Security Council are China, France, Russia, the United Kingdom, and the United States. Germany is a non-permanent member.", difficulty: "medium", source_page: 182 },
                { question: "The 'Arab League' is an organization of Arab states. Its headquarters are located in:", options: ["Riyadh", "Cairo", "Dubai", "Beirut"], correctOptionIndex: 1, explanation: "The permanent headquarters of the Arab League are in Cairo, Egypt.", difficulty: "medium", source_page: 183 },
                { question: "Which international organization is responsible for regulating international trade?", options: ["IMF", "World Bank", "WTO", "UNCTAD"], correctOptionIndex: 2, explanation: "The World Trade Organization (WTO) is an intergovernmental organization that regulates international trade.", difficulty: "easy", source_page: 184 },
                { question: "The 'Red Cross and Red Crescent Movement' is an international humanitarian movement. Its headquarters are in:", options: ["London", "Geneva", "Paris", "New York"], correctOptionIndex: 1, explanation: "The International Committee of the Red Cross (ICRC) and the International Federation of Red Cross and Red Crescent Societies are both headquartered in Geneva, Switzerland.", difficulty: "easy", source_page: 185 },
                { question: "Which international organization focuses on combating terrorism and promoting police cooperation?", options: ["Europol", "Interpol", "CIA", "FBI"], correctOptionIndex: 1, explanation: "Interpol (International Criminal Police Organization) facilitates worldwide police cooperation and crime control.", difficulty: "tough", source_page: 186 },
                { question: "The 'OPEC' (Organization of the Petroleum Exporting Countries) was established in:", options: ["1950", "1960", "1970", "1980"], correctOptionIndex: 1, explanation: "OPEC was founded in Baghdad, Iraq, in September 1960.", difficulty: "medium", source_page: 187 },
                { question: "The 'Non-Aligned Movement' (NAM) is a group of states not formally aligned with or against any major power bloc. It was established in:", options: ["1955", "1961", "1973", "1980"], correctOptionIndex: 1, explanation: "The Non-Aligned Movement (NAM) was founded in Belgrade in 1961.", difficulty: "medium", source_page: 188 },
                { question: "Which UN specialized agency focuses on educational, scientific, and cultural cooperation?", options: ["WHO", "UNESCO", "UNIDO", "WIPO"], correctOptionIndex: 1, explanation: "UNESCO (United Nations Educational, Scientific and Cultural Organization) aims to promote world peace and security through international cooperation in education, sciences, and culture.", difficulty: "easy", source_page: 189 },
                { question: "The 'African Union' (AU) is a continental union consisting of 55 member states located on the continent of Africa. Its headquarters are in:", options: ["Pretoria", "Addis Ababa", "Nairobi", "Accra"], correctOptionIndex: 1, explanation: "The headquarters of the African Union are in Addis Ababa, Ethiopia.", difficulty: "medium", source_page: 190 },
                { question: "Which of the following bodies is responsible for the financial stability of the world?", options: ["World Bank", "IMF", "WTO", "UNDP"], correctOptionIndex: 1, explanation: "The International Monetary Fund (IMF) works to foster global monetary cooperation, secure financial stability, facilitate international trade, promote high employment and sustainable economic growth, and reduce poverty around the world.", difficulty: "tough", source_page: 191 },
                { question: "The 'World Health Assembly' is the decision-making body of which organization?", options: ["UNICEF", "WHO", "UNDP", "FAO"], correctOptionIndex: 1, explanation: "The World Health Assembly is the supreme decision-making body of the World Health Organization (WHO).", difficulty: "easy", source_page: 192 },
                { question: "The 'Food and Agriculture Organization' (FAO) is a specialized agency of the UN that leads international efforts to defeat hunger. Its headquarters are in:", options: ["Geneva", "Rome", "Vienna", "Paris"], correctOptionIndex: 1, explanation: "The FAO is headquartered in Rome, Italy.", difficulty: "easy", source_page: 193 },
                { question: "Which of the following is known as the 'Parliament of the World'?", options: ["UN General Assembly", "UN Security Council", "International Court of Justice", "World Bank"], correctOptionIndex: 0, explanation: "The UN General Assembly is often referred to as the 'Parliament of the World' because all member states have equal representation.", difficulty: "medium", source_page: 194 },
                { question: "The 'Commonwealth of Nations' is a political association of 56 member states. Its headquarters are in:", options: ["Canberra", "London", "Ottawa", "New Delhi"], correctOptionIndex: 1, explanation: "The Commonwealth Secretariat, the central intergovernmental organization of the Commonwealth of Nations, is located in London, United Kingdom.", difficulty: "medium", source_page: 195 },
                { question: "Which organization was awarded the Nobel Peace Prize in 2012 for its efforts to advance peace and reconciliation in Syria?", options: ["Amnesty International", "Doctors Without Borders", "European Union", "UN Peacekeeping Forces"], correctOptionIndex: 2, explanation: "The European Union was awarded the Nobel Peace Prize in 2012 for its role in advancing peace, reconciliation, democracy, and human rights in Europe.", difficulty: "tough", source_page: 196 },
                { question: "The 'Shanghai Cooperation Organization' (SCO) is a Eurasian political, economic, and security organization. Its official languages include:", options: ["English and Russian", "Chinese and Russian", "English and Chinese", "Russian and French"], correctOptionIndex: 1, explanation: "The official working languages of the SCO are Chinese and Russian.", difficulty: "tough", source_page: 197 },
                { question: "Which of the following is the largest free trade area in the world?", options: ["EU", "NAFTA (now USMCA)", "ASEAN Free Trade Area", "Mercosur"], correctOptionIndex: 1, explanation: "The North American Free Trade Agreement (NAFTA), now replaced by USMCA, was one of the world's largest free trade areas.", difficulty: "tough", source_page: 198 },
                { question: "The 'Organization of Islamic Cooperation' (OIC) is the second largest inter-governmental organization after the United Nations. Its headquarters are in:", options: ["Rabat", "Jeddah", "Ankara", "Cairo"], correctOptionIndex: 1, explanation: "The OIC is headquartered in Jeddah, Saudi Arabia.", difficulty: "easy", source_page: 199 },
                { question: "Which of the following international organizations deals with atomic energy for peaceful purposes?", options: ["IAEA", "CERN", "NATO", "WHO"], correctOptionIndex: 0, explanation: "The International Atomic Energy Agency (IAEA) is an international organization that seeks to promote the peaceful use of nuclear energy and to inhibit its use for any military purpose, including nuclear weapons.", difficulty: "medium", source_page: 200 },
                { question: "What is the primary function of the World Economic Forum (WEF)?", options: ["To promote military alliances", "To regulate global financial markets", "To engage business, political, academic, and other leaders to shape global, regional, and industry agendas", "To provide humanitarian aid"], correctOptionIndex: 2, explanation: "The WEF is an international non-governmental and lobbying organisation, founded on 24 January 1971, based in Cologny, Geneva Canton, Switzerland. It is committed to improving the state of the world by engaging business, political, academic, and other leaders of society to shape global, regional, and industry agendas.", difficulty: "tough", source_page: 171 },
                { question: "Which international agreement aims to reduce greenhouse gas emissions?", options: ["Vienna Convention", "Montreal Protocol", "Kyoto Protocol", "Ramsar Convention"], correctOptionIndex: 2, explanation: "The Kyoto Protocol is an international treaty that commits State Parties to reduce greenhouse gas emissions.", difficulty: "medium", source_page: 177 },
                { question: "Which country is NOT a member of the BRICS group?", options: ["Brazil", "Russia", "India", "Indonesia"], correctOptionIndex: 3, explanation: "BRICS is an acronym for the association of five major emerging national economies: Brazil, Russia, India, China, and South Africa. Indonesia is not a member.", difficulty: "medium", source_page: 178 },
                { question: "The 'World Intellectual Property Organization' (WIPO) is a self-funding agency of the United Nations. Its headquarters are in:", options: ["Paris", "Geneva", "Washington D.C.", "Brussels"], correctOptionIndex: 1, explanation: "WIPO is headquartered in Geneva, Switzerland.", difficulty: "medium", source_page: 180 },
                { question: "Which organization's main objective is to promote human rights globally?", options: ["Amnesty International", "Red Cross", "Doctors Without Borders", "Greenpeace"], correctOptionIndex: 0, explanation: "Amnesty International is an international non-governmental organization focused on human rights.", difficulty: "easy", source_page: 185 },
                { question: "Which of the following is a regional organization promoting cooperation among South Asian countries?", options: ["ECO", "SAARC", "ASEAN", "AU"], correctOptionIndex: 1, explanation: "The South Asian Association for Regional Cooperation (SAARC) is the regional intergovernmental organization and geopolitical union of states in South Asia.", difficulty: "easy", source_page: 183 },
                { question: "The 'Colombo Plan' is a regional organization that promotes economic and social development in Asia and the Pacific. It was established in:", options: ["1945", "1950", "1960", "1970"], correctOptionIndex: 1, explanation: "The Colombo Plan was conceived at the Commonwealth Conference on Foreign Policy held in Colombo, Ceylon (now Sri Lanka) in January 1950 and was launched on 1 July 1951.", difficulty: "tough", source_page: 195 },
                { question: "Which international financial institution provides loans and grants to governments of low- and middle-income countries for the purpose of pursuing capital projects?", options: ["IMF", "World Bank", "WTO", "Asian Development Bank"], correctOptionIndex: 1, explanation: "The World Bank is an international financial institution that provides loans and grants to the governments of poorer countries for the purpose of pursuing capital projects.", difficulty: "easy", source_page: 176 },
                { question: "The 'International Civil Aviation Organization' (ICAO) is a UN specialized agency tasked with coordinating international air travel. Its headquarters are in:", options: ["London", "Montreal", "Brussels", "New York"], correctOptionIndex: 1, explanation: "ICAO's headquarters are located in Montreal, Canada.", difficulty: "medium", source_page: 180 },
                { question: "Which international organization focuses on global cooperation to prevent infectious diseases?", options: ["WHO", "UNICEF", "FAO", "UNDP"], correctOptionIndex: 0, explanation: "The World Health Organization (WHO) is a specialized agency of the United Nations responsible for international public health.", difficulty: "easy", source_page: 192 },
                { question: "The 'International Maritime Organization' (IMO) is a UN specialized agency responsible for regulating shipping. Its headquarters are in:", options: ["Hamburg", "London", "Rotterdam", "Singapore"], correctOptionIndex: 1, explanation: "The IMO is headquartered in London, United Kingdom.", difficulty: "medium", source_page: 180 },
                { question: "Which UN body addresses the rights and well-being of indigenous peoples?", options: ["UNICEF", "UNDP", "Permanent Forum on Indigenous Issues", "UN-Habitat"], correctOptionIndex: 2, explanation: "The Permanent Forum on Indigenous Issues is an advisory body to the Economic and Social Council on indigenous issues.", difficulty: "tough", source_page: 174 },
                { question: "Which organization works to promote international peace through educational, scientific, and cultural reforms?", options: ["WHO", "UNICEF", "UNESCO", "ILO"], correctOptionIndex: 2, explanation: "UNESCO is the United Nations Educational, Scientific and Cultural Organization.", difficulty: "easy", source_page: 189 },
                { question: "The 'World Customs Organization' (WCO) is an intergovernmental organization that works to enhance the effectiveness and efficiency of customs administrations. Its headquarters are in:", options: ["Brussels", "Geneva", "Vienna", "London"], correctOptionIndex: 0, explanation: "The WCO is headquartered in Brussels, Belgium.", difficulty: "medium", source_page: 184 },
                { question: "Which of the following is a major multilateral development bank that provides financing to Asian countries?", options: ["African Development Bank", "Inter-American Development Bank", "Asian Development Bank", "European Investment Bank"], correctOptionIndex: 2, explanation: "The Asian Development Bank (ADB) is a regional development bank established on 19 December 1966, which is headquartered in Mandaluyong, Metro Manila, Philippines.", difficulty: "easy", source_page: 181 },
                { question: "The 'International Renewable Energy Agency' (IRENA) promotes the widespread and increased adoption and sustainable use of all forms of renewable energy. Its headquarters are in:", options: ["Bonn", "Abu Dhabi", "Copenhagen", "New Delhi"], correctOptionIndex: 1, explanation: "IRENA is headquartered in Masdar City, Abu Dhabi, United Arab Emirates.", difficulty: "tough", source_page: 190 },
                { question: "Which international agreement set specific targets for developed countries to reduce greenhouse gas emissions?", options: ["Paris Agreement", "Kyoto Protocol", "Copenhagen Accord", "Doha Round"], correctOptionIndex: 1, explanation: "The Kyoto Protocol, adopted in 1997, committed industrialised countries to limit and reduce greenhouse gases emissions.", difficulty: "medium", source_page: 177 },
                { question: "The 'Organization for the Prohibition of Chemical Weapons' (OPCW) is the implementing body for the Chemical Weapons Convention. Its headquarters are in:", options: ["Geneva", "Vienna", "The Hague", "Brussels"], correctOptionIndex: 2, explanation: "The OPCW is based in The Hague, Netherlands.", difficulty: "tough", source_page: 179 },
                { question: "Which UN program is the leading global voice on the environment?", options: ["UNDP", "UNEP", "UN-Habitat", "UNFPA"], correctOptionIndex: 1, explanation: "The United Nations Environment Programme (UNEP) is the global environmental authority that sets the global environmental agenda.", difficulty: "easy", source_page: 189 },
                { question: "The 'World Tourism Organization' (UNWTO) is a specialized agency of the United Nations responsible for the promotion of responsible, sustainable and universally accessible tourism. Its headquarters are in:", options: ["Madrid", "Rome", "Paris", "Geneva"], correctOptionIndex: 0, explanation: "UNWTO is headquartered in Madrid, Spain.", difficulty: "medium", source_page: 180 },
                { question: "Which of the following is NOT a principal organ of the United Nations?", options: ["General Assembly", "Security Council", "Economic and Social Council", "International Red Cross"], correctOptionIndex: 3, explanation: "The International Red Cross and Red Crescent Movement is an independent humanitarian organization, not a principal organ of the United Nations.", difficulty: "easy", source_page: 174 },
                { question: "The 'International Organization for Migration' (IOM) is the leading intergovernmental organization in the field of migration. Its headquarters are in:", options: ["New York", "Geneva", "Vienna", "Brussels"], correctOptionIndex: 1, explanation: "IOM is headquartered in Geneva, Switzerland.", difficulty: "medium", source_page: 180 },
                { question: "The 'World Economic Forum' is annually held in:", options: ["Davos, Switzerland", "New York, USA", "London, UK", "Paris, France"], correctOptionIndex: 0, explanation: "The World Economic Forum's annual meeting takes place in Davos, Switzerland.", difficulty: "easy", source_page: 171 },
                { question: "Which UN agency focuses on population and development issues?", options: ["UNICEF", "UNDP", "UNFPA", "WHO"], correctOptionIndex: 2, explanation: "The United Nations Population Fund (UNFPA) is a UN agency aimed at improving reproductive and maternal health worldwide.", difficulty: "medium", source_page: 175 },
                { question: "The 'International Telecommunication Union' (ITU) is a specialized agency of the United Nations responsible for issues that concern information and communication technologies. Its headquarters are in:", options: ["Brussels", "Geneva", "Vienna", "Paris"], correctOptionIndex: 1, explanation: "The ITU is headquartered in Geneva, Switzerland.", difficulty: "medium", source_page: 180 }
            ];
            quizQuestions.push(...generalKnowledgeMCQs);

            // Urdu (Pages 43-46) - Idioms and Proverbs & Aligarh Movement - Aim for 25 questions
            const urduMCQs = [
                { question: "'اونٹ کے منہ میں زیرہ' محاورے کا کیا مطلب ہے؟", options: ["بہت زیادہ چیز", "بہت کم چیز", "ضرورت سے زیادہ", "بے معنی چیز"], correctOptionIndex: 1, explanation: "اس محاورے کا مطلب ہے کہ کسی بہت بڑی ضرورت کے مقابلے میں بہت تھوڑی چیز کا ہونا۔", difficulty: "easy", source_page: 43 },
                { question: "'آگ بگولہ ہونا' کا کیا مطلب ہے؟", options: ["خوش ہونا", "بہت غصہ ہونا", "پریشان ہونا", "خاموش ہو جانا"], correctOptionIndex: 1, explanation: "آگ بگولہ ہونے کا مطلب ہے شدید غصے میں آ جانا۔", difficulty: "easy", source_page: 43 },
                { question: "'ایک انار سو بیمار' کا کیا مطلب ہے؟", options: ["ایک چیز کے بہت سے خریدار", "بیمار کی کثرت", "انار کی پیداوار کم ہونا", "ایک ڈاکٹر اور بہت سے مریض"], correctOptionIndex: 0, explanation: "اس کا مطلب ہے کہ ایک ہی چیز کی طلب بہت زیادہ ہو اور فراہم کرنے والے کم ہوں۔", difficulty: "medium", source_page: 44 },
                { question: "'بغض ناہنجار' سے کیا مراد ہے؟", options: ["دوستی", "نفرت", "محبت", "لگاؤ"], correctOptionIndex: 1, explanation: "بغض ناہنجار کا مطلب ہے شدید یا بری نفرت۔", difficulty: "tough", source_page: 45 },
                { question: "'پانچوں انگلیاں گھی میں' کا مطلب ہے:", options: ["بہت بھوک لگنا", "ہر طرف سے فائدہ ہی فائدہ ہونا", "پریشانی میں ہونا", "مال و دولت جمع کرنا"], correctOptionIndex: 1, explanation: "اس محاورے کا مطلب ہے کہ انسان ہر طرح سے فائدے میں ہو۔", difficulty: "easy", source_page: 43 },
                { question: "'دال میں کچھ کالا ہونا' کا کیا مطلب ہے؟", options: ["کھانے کا ذائقہ خراب ہونا", "کسی بات میں گڑبڑ ہونا یا شک ہونا", "کھانا جل جانا", "دال کا رنگ کالا ہونا"], correctOptionIndex: 1, explanation: "اس محاورے کا مطلب ہے کہ کسی معاملے میں کوئی شک یا راز چھپا ہو۔", difficulty: "easy", source_page: 43 },
                { question: "'چاند پر تھوکنا' کا کیا مطلب ہے؟", options: ["کسی محترم ہستی پر کیچڑ اچھالنا", "چاند کو آلودہ کرنا", "ناممکن کام کرنا", "فضول کام کرنا"], correctOptionIndex: 0, explanation: "اس کا مطلب ہے کہ کسی قابل احترام شخصیت یا چیز کی توہین کرنے کی کوشش کرنا۔", difficulty: "medium", source_page: 44 },
                { question: "'ناچ نہ جانے آنگن ٹیڑھا' کا کیا مطلب ہے؟", options: ["ناچنا نہ آتا ہو تو بہانے بنانا", "ناچنے کی جگہ کا خراب ہونا", "ناچنا مشکل ہونا", "بہت اچھا ناچنا"], correctOptionIndex: 0, explanation: "اس کا مطلب ہے کہ اپنی خامی کو چھپانے کے لیے دوسروں پر الزام لگانا یا بہانے بنانا۔", difficulty: "medium", source_page: 44 },
                { question: "'امیر خسرو' کا تعلق کس تحریک سے تھا؟", options: ["صوفی تحریک", "تحریک علی گڑھ", "فارسی ادب", "بھکتی تحریک"], correctOptionIndex: 0, explanation: "امیر خسرو کا تعلق صوفی تحریک اور ہند اسلامی ثقافت سے تھا۔ یہ سوال تحریک علی گڑھ کے حوالے سے مبہم ہے۔", difficulty: "tough", source_page: 46 },
                { question: "تحریک علی گڑھ کس نے شروع کی تھی؟", options: ["سرسید احمد خان", "مولانا محمد علی جوہر", "علامہ اقبال", "قائداعظم"], correctOptionIndex: 0, explanation: "تحریک علی گڑھ کی بنیاد سرسید احمد خان نے رکھی تھی جس کا مقصد مسلمانوں میں جدید تعلیم کو فروغ دینا تھا۔", difficulty: "easy", source_page: 45 },
                { question: "علی گڑھ مسلم یونیورسٹی کا پرانا نام کیا تھا؟", options: ["محمڈن اینگلو اورینٹل کالج", "گورنمنٹ کالج علی گڑھ", "علی گڑھ کالج", "اسلامیہ کالج علی گڑھ"], correctOptionIndex: 0, explanation: "علی گڑھ مسلم یونیورسٹی کا پرانا نام محمڈن اینگلو اورینٹل کالج (MAO College) تھا۔", difficulty: "easy", source_page: 45 },
                { question: "تحریک علی گڑھ کا اہم مقصد کیا تھا؟", options: ["مسلمانوں میں مذہبی تعلیم کو فروغ دینا", "مسلمانوں میں سیاسی بیداری پیدا کرنا", "مسلمانوں میں جدید اور سائنسی تعلیم کو فروغ دینا", "مسلمانوں کو حکومت کے خلاف بغاوت پر اکسانا"], correctOptionIndex: 2, explanation: "تحریک علی گڑھ کا بنیادی مقصد مسلمانوں کو جدید اور سائنسی تعلیم سے آراستہ کر کے انہیں دورِ جدید کے تقاضوں سے ہم آہنگ کرنا تھا۔", difficulty: "medium", source_page: 45 },
                { question: "'ماڈرن مسلم انڈیا' کی اصطلاح کس کے ساتھ منسوب ہے؟", options: ["سرسید احمد خان", "نواب محسن الملک", "مولانا شبلی نعمانی", "قائداعظم"], correctOptionIndex: 0, explanation: "سرسید احمد خان کو 'ماڈرن مسلم انڈیا' کا معمار سمجھا جاتا ہے کیونکہ انہوں نے مسلمانوں کی فکری اور تعلیمی حالت کو بہتر بنانے کے لیے اہم اقدامات کیے۔", difficulty: "tough", source_page: 46 },
                { question: "'آب آب ہونا' محاورے کا کیا مطلب ہے؟", options: ["پانی پینا", "بہت شرمندہ ہونا", "غسل کرنا", "پانی میں ڈوبنا"], correctOptionIndex: 1, explanation: "آب آب ہونا کا مطلب ہے بہت زیادہ شرمندہ ہونا۔", difficulty: "medium", source_page: 43 },
                { question: "'آٹے میں نمک' کا کیا مطلب ہے؟", options: ["کسی چیز کی بہت زیادہ مقدار", "کسی چیز کی بہت کم مقدار", "آٹا اور نمک ملانا", "بے فائدہ چیز"], correctOptionIndex: 1, explanation: "آٹے میں نمک کا مطلب ہے کسی چیز کا بہت قلیل مقدار میں ہونا، نہ ہونے کے برابر۔", difficulty: "easy", source_page: 43 },
                { question: "'ٹکے سیر بھاجی ٹکے سیر کھاجا' کا کیا مطلب ہے؟", options: ["ہر چیز کی قیمت کم ہونا", "اچھی بری چیز میں تمیز نہ کرنا", "بہت مہنگی چیز", "سستے داموں بیچنا"], correctOptionIndex: 1, explanation: "اس کا مطلب ہے کہ اچھی اور بری چیز میں تمیز نہ کرنا، ہر چیز کو ایک ہی قیمت پر دیکھنا۔", difficulty: "medium", source_page: 44 },
                { question: "سرسید احمد خان نے سائنٹیفک سوسائٹی کب قائم کی؟", options: ["1857", "1864", "1875", "1888"], correctOptionIndex: 1, explanation: "سرسید احمد خان نے 1864 میں سائنٹیفک سوسائٹی قائم کی جس کا مقصد انگریزی سائنسی کتابوں کا اردو میں ترجمہ کرنا تھا۔", difficulty: "tough", source_page: 45 },
                { question: "'بغل میں چھری منہ میں رام رام' کا مطلب ہے؟", options: ["ظاہری ہمدردی اور باطنی دشمنی", "سیدھا سادھا آدمی", "مخلص دوست", "صوفیانہ طبیعت"], correctOptionIndex: 0, explanation: "اس محاورے کا مطلب ہے کہ انسان ظاہر میں اچھا بنے لیکن باطن میں دشمنی رکھے۔", difficulty: "medium", source_page: 44 },
                { question: "تحریک علی گڑھ کے بانی سرسید احمد خان کا یوم وفات کیا ہے؟", options: ["27 مارچ 1898", "19 اپریل 1897", "11 ستمبر 1888", "14 جون 1900"], correctOptionIndex: 0, explanation: "سرسید احمد خان کا انتقال 27 مارچ 1898 کو ہوا۔", difficulty: "tough", source_page: 45 },
                { question: "'دلّی ابھی دور ہے' کا کیا مطلب ہے؟", options: ["دلی کا بہت دور ہونا", "منزل ابھی دور ہے", "سفر کرنا مشکل ہے", "کام ختم ہو گیا ہے"], correctOptionIndex: 1, explanation: "اس کا مطلب ہے کہ مقصد یا منزل حاصل ہونے میں ابھی بہت وقت یا رکاوٹیں ہیں۔", difficulty: "easy", source_page: 43 },
                { question: "'کاغذی گھوڑے دوڑانا' کا کیا مطلب ہے؟", options: ["خالی خولی باتیں کرنا", "تیزی سے سفر کرنا", "لکھنے میں ماہر ہونا", "دستاویزات جمع کرنا"], correctOptionIndex: 0, explanation: "اس محاورے کا مطلب ہے کہ صرف لکھت پڑھت میں مشغول رہنا اور عملی کام نہ کرنا۔", difficulty: "medium", source_page: 44 },
                { question: "علی گڑھ تحریک کے مقاصد میں شامل نہیں تھا:", options: ["سیاسی آزادی", "جدید تعلیم کا فروغ", "معاشرتی اصلاح", "مغربی علوم کا حصول"], correctOptionIndex: 0, explanation: "تحریک علی گڑھ کا فوری مقصد مسلمانوں کی سیاسی آزادی حاصل کرنا نہیں تھا بلکہ تعلیم اور سماجی اصلاح پر زور دینا تھا۔", difficulty: "tough", source_page: 45 },
                { question: "'پاؤں بھاری ہونا' کا کیا مطلب ہے؟", options: ["تھک جانا", "حمل سے ہونا", "چلنے میں دشواری", "بیمار ہونا"], correctOptionIndex: 1, explanation: "یہ محاورہ حمل (pregnancy) کی حالت کو ظاہر کرتا ہے۔", difficulty: "medium", source_page: 43 },
                { question: "'زمین آسمان کے قلابے ملانا' کا کیا مطلب ہے؟", options: ["بہت زیادہ تعریف کرنا", "ناممکن بات کرنا", "جھوٹ بولنا", "مشکل کام کرنا"], correctOptionIndex: 0, explanation: "اس کا مطلب ہے کسی کی بہت زیادہ مبالغہ آمیز تعریف کرنا۔", difficulty: "medium", source_page: 44 },
                { question: "کس شخصیت کو 'سرسید ثانی' کہا جاتا ہے؟", options: ["مولانا الطاف حسین حالی", "نواب محسن الملک", "مولوی چراغ علی", "مولانا محمد علی جوہر"], correctOptionIndex: 1, explanation: "نواب محسن الملک کو سرسید احمد خان کے بعد تحریک علی گڑھ کو آگے بڑھانے میں ان کے اہم کردار کی وجہ سے 'سرسید ثانی' کہا جاتا ہے۔", difficulty: "tough", source_page: 46 }
            ];
            quizQuestions.push(...urduMCQs);

            // Islamic Studies (Pages 24-28) - Solved Important Questions - Aim for 25 questions
            const islamicStudiesMCQs = [
                { question: "قرآن مجید کی سب سے چھوٹی سورت کون سی ہے؟", options: ["سورۃ فاتحہ", "سورۃ کوثر", "سورۃ اخلاص", "سورۃ عصر"], correctOptionIndex: 1, explanation: "سورۃ کوثر قرآن مجید کی سب سے چھوٹی سورت ہے، جس میں صرف تین آیات ہیں۔", difficulty: "easy", source_page: 24 },
                { question: "اسلام کے ارکان کتنے ہیں؟", options: ["چار", "پانچ", "چھ", "سات"], correctOptionIndex: 1, explanation: "اسلام کے پانچ ارکان ہیں: کلمہ طیبہ، نماز، روزہ، زکوٰۃ، اور حج۔", difficulty: "easy", source_page: 24 },
                { question: "کلمہ طیبہ کا دوسرا نام کیا ہے؟", options: ["کلمہ شہادت", "کلمہ توحید", "کلمہ تمجید", "کلمہ رد کفر"], correctOptionIndex: 1, explanation: "کلمہ طیبہ کو کلمہ توحید بھی کہتے ہیں کیونکہ یہ اللہ تعالیٰ کی وحدانیت کا اقرار ہے۔", difficulty: "medium", source_page: 25 },
                { question: "کس صحابی کو 'اسد اللہ' کا لقب دیا گیا؟", options: ["حضرت ابوبکر صدیق", "حضرت عمر فاروق", "حضرت عثمان غنی", "حضرت علی مرتضیٰ"], correctOptionIndex: 3, explanation: "حضرت علی مرتضیٰ کو 'اسد اللہ' (اللہ کا شیر) کا لقب دیا گیا۔", difficulty: "easy", source_page: 25 },
                { question: "زکوٰۃ کس پر فرض ہے؟", options: ["ہر مسلمان پر", "صاحب نصاب مسلمان پر", "صرف مردوں پر", "صرف عورتوں پر"], correctOptionIndex: 1, explanation: "زکوٰۃ صرف اس مسلمان پر فرض ہے جو صاحب نصاب ہو، یعنی جس کے پاس ایک مخصوص مقدار میں مال ہو۔", difficulty: "easy", source_page: 26 },
                { question: "قرآن مجید میں سب سے زیادہ کس پیغمبر کا ذکر آیا ہے؟", options: ["حضرت آدم", "حضرت نوح", "حضرت ابراہیم", "حضرت موسیٰ"], correctOptionIndex: 3, explanation: "قرآن مجید میں حضرت موسیٰ علیہ السلام کا ذکر سب سے زیادہ مرتبہ (136 بار) آیا ہے۔", difficulty: "tough", source_page: 26 },
                { question: "غزوہ بدر کب پیش آیا؟", options: ["1 ہجری", "2 ہجری", "3 ہجری", "4 ہجری"], correctOptionIndex: 1, explanation: "غزوہ بدر 2 ہجری میں پیش آیا، جو اسلام کی پہلی بڑی جنگ تھی۔", difficulty: "easy", source_page: 27 },
                { question: "حج کس پر فرض ہے؟", options: ["صاحب استطاعت مسلمان پر", "ہر بالغ مسلمان پر", "صرف مالداروں پر", "صرف صحت مندوں پر"], correctOptionIndex: 0, explanation: "حج صرف اس مسلمان پر فرض ہے جو صاحب استطاعت ہو، یعنی جسمانی اور مالی دونوں لحاظ سے اس کی طاقت رکھتا ہو۔", difficulty: "easy", source_page: 27 },
                { question: "قرآن مجید کے کتنے سیپارے ہیں؟", options: ["29", "30", "31", "32"], correctOptionIndex: 1, explanation: "قرآن مجید 30 سیپاروں میں تقسیم ہے۔", difficulty: "easy", source_page: 24 },
                { question: "کس اسلامی ماہ میں روزے رکھے جاتے ہیں؟", options: ["محرم", "رجب", "رمضان", "شوال"], correctOptionIndex: 2, explanation: "روزے اسلامی ماہ رمضان میں رکھے جاتے ہیں۔", difficulty: "easy", source_page: 24 },
                { question: "کس نماز کو 'صلاة الوسطیٰ' کہا جاتا ہے؟", options: ["فجر", "ظہر", "عصر", "عشاء"], correctOptionIndex: 2, explanation: "عصر کی نماز کو قرآن میں 'صلاة الوسطیٰ' کہا گیا ہے۔", difficulty: "medium", source_page: 25 },
                { question: "فتح مکہ کب ہوئی؟", options: ["6 ہجری", "7 ہجری", "8 ہجری", "9 ہجری"], correctOptionIndex: 2, explanation: "فتح مکہ 8 ہجری میں ہوئی جب مسلمان فاتحانہ طور پر مکہ میں داخل ہوئے۔", difficulty: "medium", source_page: 27 },
                { question: "کس غزوہ کو 'غزوہ احزاب' بھی کہا جاتا ہے؟", options: ["غزوہ بدر", "غزوہ احد", "غزوہ خندق", "غزوہ خیبر"], correctOptionIndex: 2, explanation: "غزوہ خندق کو 'غزوہ احزاب' (جماعتوں کی جنگ) بھی کہا جاتا ہے کیونکہ بہت سے قبائل نے مل کر مسلمانوں پر حملہ کیا تھا۔", difficulty: "medium", source_page: 27 },
                { question: "قرآن مجید میں کل کتنی سورتیں ہیں؟", options: ["110", "112", "114", "116"], correctOptionIndex: 2, explanation: "قرآن مجید میں کل 114 سورتیں ہیں۔", difficulty: "easy", source_page: 24 },
                { question: "نماز میں سب سے پہلے کیا پڑھا جاتا ہے؟", options: ["سورۃ فاتحہ", "تکبیر تحریمہ", "ثناء", "سورۃ اخلاص"], correctOptionIndex: 1, explanation: "نماز کی ابتداء تکبیر تحریمہ (اللہ اکبر) سے ہوتی ہے۔", difficulty: "easy", source_page: 25 },
                { question: "'بیت المقدس' کس شہر میں واقع ہے؟", options: ["مدینہ", "مکہ", "قدس (یروشلم)", "دمشق"], correctOptionIndex: 2, explanation: "بیت المقدس، جسے مسجد اقصیٰ بھی کہا جاتا ہے، قدس (یروشلم) میں واقع ہے۔", difficulty: "medium", source_page: 26 },
                { question: "کس صحابی کو 'ذو النورین' کا لقب ملا؟", options: ["حضرت ابوبکر صدیق", "حضرت عمر فاروق", "حضرت عثمان غنی", "حضرت علی مرتضیٰ"], correctOptionIndex: 2, explanation: "حضرت عثمان غنی کو 'ذو النورین' (دو نوروں والا) کا لقب ملا کیونکہ انہوں نے رسول اللہ ﷺ کی دو بیٹیوں سے شادی کی۔", difficulty: "medium", source_page: 25 },
                { question: "کس اسلامی ماہ میں ہجرت مدینہ ہوئی تھی؟", options: ["محرم", "ربیع الاول", "شوال", "ذوالحجہ"], correctOptionIndex: 1, explanation: "ہجرت مدینہ ربیع الاول کے مہینے میں ہوئی تھی۔", difficulty: "tough", source_page: 27 },
                { question: "قرآن مجید کی سب سے لمبی آیت کون سی ہے؟", options: ["آیت الکرسی", "آیت الدَین", "آیت نور", "آیت سجدہ"], correctOptionIndex: 1, explanation: "قرآن مجید کی سب سے لمبی آیت سورۃ البقرہ کی آیت نمبر 282 ہے جو 'آیت الدَین' کے نام سے مشہور ہے۔", difficulty: "tough", source_page: 24 },
                { question: "کس پیغمبر نے سب سے پہلے خانہ کعبہ کی تعمیر کی؟", options: ["حضرت آدم", "حضرت نوح", "حضرت ابراہیم", "حضرت محمد ﷺ"], correctOptionIndex: 2, explanation: "حضرت ابراہیم علیہ السلام اور ان کے بیٹے حضرت اسماعیل علیہ السلام نے مل کر خانہ کعبہ کی بنیادیں اٹھائیں۔", difficulty: "easy", source_page: 26 },
                { question: "معراج کا واقعہ کب پیش آیا؟", options: ["رجب 10 نبوی", "ربیع الاول 11 نبوی", "شوال 12 نبوی", "ذوالحجہ 13 نبوی"], correctOptionIndex: 0, explanation: "معراج کا واقعہ ہجرت سے تقریباً ایک سال قبل رجب کے مہینے میں پیش آیا، جو 10 نبوی کے قریب ہے۔", difficulty: "tough", source_page: 28 },
                { question: "کس غزوہ میں حضرت حمزہ شہید ہوئے؟", options: ["غزوہ بدر", "غزوہ احد", "غزوہ خندق", "غزوہ خیبر"], correctOptionIndex: 1, explanation: "حضرت حمزہ رضی اللہ عنہ غزوہ احد میں شہید ہوئے۔", difficulty: "medium", source_page: 27 },
                { question: "اذان میں 'حی علی الفلاح' کے بعد کیا کہا جاتا ہے؟", options: ["اللہ اکبر", "لا الہ الا اللہ", "الصلاة خیر من النوم", "قد قامت الصلاة"], correctOptionIndex: 2, explanation: "فجر کی اذان میں 'حی علی الفلاح' کے بعد 'الصلاة خیر من النوم' کہا جاتا ہے۔", difficulty: "medium", source_page: 25 },
                { question: "کس خلیفہ راشد کا دورِ خلافت سب سے طویل تھا؟", options: ["حضرت ابوبکر صدیق", "حضرت عمر فاروق", "حضرت عثمان غنی", "حضرت علی مرتضیٰ"], correctOptionIndex: 2, explanation: "حضرت عثمان غنی رضی اللہ عنہ کا دورِ خلافت تقریباً 12 سال رہا جو خلفائے راشدین میں سب سے طویل ہے۔", difficulty: "tough", source_page: 28 },
                { question: "قرآن مجید میں 'ذوالقرنین' کا ذکر کس سورت میں آیا ہے؟", options: ["سورۃ کہف", "سورۃ مریم", "سورۃ طٰہٰ", "سورۃ انبیاء"], correctOptionIndex: 0, explanation: "ذوالقرنین کا ذکر قرآن مجید کی سورۃ کہف میں آیا ہے۔", difficulty: "tough", source_page: 26 }
            ];
            quizQuestions.push(...islamicStudiesMCQs);


            // Distribute questions to reach 100 with emphasis on difficulty and logic
            // Start with a base of difficult and logical questions
            let allQuestions = [];
            allQuestions.push(...generalKnowledgeMCQs, ...urduMCQs, ...islamicStudiesMCQs);

            // Filter questions by difficulty
            let easyQuestions = allQuestions.filter(q => q.difficulty === 'easy');
            let mediumQuestions = allQuestions.filter(q => q.difficulty === 'medium');
            let toughQuestions = allQuestions.filter(q => q.difficulty === 'tough');

            // Shuffle each difficulty pool
            shuffleArray(easyQuestions);
            shuffleArray(mediumQuestions);
            shuffleArray(toughQuestions);

            // Target distribution: 10 Easy, 50 Medium, 40 Tough for a challenging quiz (Total 100)
            const targetEasy = 10;
            const targetMedium = 50;
            const targetTough = 40;
            const totalQuestions = 100;

            let finalQuiz = [];

            // Add questions based on target counts
            finalQuiz = finalQuiz.concat(easyQuestions.slice(0, Math.min(easyQuestions.length, targetEasy)));
            finalQuiz = finalQuiz.concat(mediumQuestions.slice(0, Math.min(mediumQuestions.length, targetMedium)));
            finalQuiz = finalQuiz.concat(toughQuestions.slice(0, Math.min(toughQuestions.length, targetTough)));

            // If we still need more questions to reach 100, add from remaining pools, prioritizing tough/medium
            let remaining = totalQuestions - finalQuiz.length;
            if (remaining > 0) {
                // Collect all remaining questions
                let remainingPool = [
                    ...easyQuestions.slice(targetEasy),
                    ...mediumQuestions.slice(targetMedium),
                    ...toughQuestions.slice(targetTough)
                ];
                shuffleArray(remainingPool); // Shuffle them to ensure randomness
                finalQuiz = finalQuiz.concat(remainingPool.slice(0, remaining));
            }

            // Ensure exactly 100 questions (trim if somehow over, though the logic above should prevent it)
            quizQuestions = finalQuiz.slice(0, totalQuestions);

            // Final shuffle of the entire quiz to randomize the order of questions from different categories
            shuffleArray(quizQuestions);

            // Select one random question to be the "special" question for the day
            specialQuestionIndex = Math.floor(Math.random() * quizQuestions.length);
            quizQuestions[specialQuestionIndex].special = true;

            // Log final question counts by difficulty for verification
            let finalEasyCount = quizQuestions.filter(q => q.difficulty === 'easy').length;
            let finalMediumCount = quizQuestions.filter(q => q.difficulty === 'medium').length;
            let finalToughCount = quizQuestions.filter(q => q.difficulty === 'tough').length;
            console.log(`Final Question Counts: Easy=${finalEasyCount}, Medium=${finalMediumCount}, Tough=${finalToughCount}, Total=${quizQuestions.length}`);

        }

        // Initialize the quiz when the DOM is fully loaded
        document.addEventListener('DOMContentLoaded', () => {
            // Set the login ID dynamically based on the CURRENT_DATE_STR (e.g., 20JUNE)
            const dateParts = CURRENT_DATE_STR.split(' ');
            const monthName = dateParts[0].toUpperCase().substring(0, 3); // Get first 3 letters of month
            const day = parseInt(dateParts[1].replace(',', '')); // Get day number
            document.getElementById('loginId').value = `${day}${monthName}`; // Example: 20JUNE

            initializeQuiz(); // Populate quizQuestions array
            
            // Adjust sticky date position based on screen width for mobile responsiveness
            const liveDateElement = document.getElementById('liveDate');
            if (window.innerWidth < 768) {
                liveDateElement.style.alignSelf = 'flex-start';
            } else {
                liveDateElement.style.alignSelf = 'flex-end';
            }
        });

        // Handle mobile sticky date position on window resize
        window.addEventListener('resize', () => {
            const liveDateElement = document.getElementById('liveDate');
            if (window.innerWidth < 768) {
                liveDateElement.style.alignSelf = 'flex-start';
            } else {
                liveDateElement.style.alignSelf = 'flex-end';
            }
        });
    </script>
</body>
</html>
